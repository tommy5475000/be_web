generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model TaiKhoan {
  user_id      Int     @id @default(autoincrement())
  kiotUserId   Int?    @unique(map: "kiotUserId")
  userName     String? @db.VarChar(30)
  givenName    String? @db.VarChar(255)
  address      String? @db.VarChar(255)
  mobilePhone  String? @db.VarChar(20)
  retailerId   Int?
  birthDate    String? @db.VarChar(50)
  passWord     String? @db.VarChar(50)
  vaiTro       String? @db.VarChar(50)
  email        String? @db.VarChar(255)
  trangThai    String? @db.VarChar(50)
  createdDate  String? @db.VarChar(50)
  modifiedDate String? @db.VarChar(50)
}

model TradeMark {
  id   Int     @id
  name String? @db.VarChar(255)
}

model Invoice {
  stt            Int              @id @default(autoincrement())
  id             Int              @unique(map: "id")
  uuid           String?          @db.VarChar(255)
  sohd           String           @unique(map: "sohd") @db.VarChar(50)
  purchaseDate   String           @db.VarChar(255)
  branchId       Int
  branchName     String           @db.VarChar(255)
  soldById       Int
  soldByName     String           @db.VarChar(255)
  customerId     Int?
  customerCode   String?          @db.VarChar(50)
  customerName   String?          @db.VarChar(255)
  orderCode      String?          @db.VarChar(50)
  total          Decimal          @db.Decimal(18, 4)
  totalPayment   Decimal          @db.Decimal(18, 4)
  discount       Decimal?         @db.Decimal(18, 4)
  discountRatio  Decimal?         @db.Decimal(18, 4)
  status         Int
  statusValue    String           @db.VarChar(50)
  usingCod       Boolean
  createdDate    String           @db.VarChar(255)
  modifiedDate   String?          @db.VarChar(255)
  description    String?          @db.VarChar(255)
  saleChannelId  Int?
  totalTax       Decimal?         @db.Decimal(18, 4)
  eInvoiceStatus String?          @db.VarChar(50)
  pricingMode    Int?
  invoiceDetails invoiceDetails[]
  payments       payBills?
  returnInvoice  returnInvoice[]
}

model invoiceDetails {
  id                 Int                 @id @default(autoincrement())
  invoiceId          String
  productId          Int
  productCode        String              @db.VarChar(50)
  productName        String              @db.VarChar(255)
  categoryId         Int
  categoryName       String              @db.VarChar(255)
  tradeMarkId        Int?
  tradeMarkName      String?             @db.VarChar(255)
  quantity           Int
  price              Decimal             @db.Decimal(18, 4)
  discount           Decimal?            @db.Decimal(18, 4)
  discountRatio      Decimal?            @db.Decimal(18, 4)
  usePoint           Boolean?
  note               String?             @db.VarChar(255)
  subTotal           Decimal             @db.Decimal(18, 4)
  serialNumbers      String?             @db.Text
  returnQuantity     Int
  allocationDiscount Decimal?            @db.Decimal(18, 4)
  invoiceDetailTaxs  invoiceDetailTaxs[]
  Invoice            Invoice             @relation(fields: [invoiceId], references: [sohd], onDelete: Cascade, map: "InvoiceDetails_ibfk_1")

  @@unique([invoiceId, productCode])
}

model payBills {
  id          Int     @id @default(autoincrement())
  invoiceId   String  @unique
  id_pay      Int
  code        String  @db.VarChar(50)
  amount      Decimal @db.Decimal(18, 4)
  method      String  @db.VarChar(50)
  accountId   Int?
  bankAccount String? @db.VarChar(50)
  status      Int
  statusValue String? @db.VarChar(50)
  description String? @db.VarChar(255)
  transDate   String? @db.VarChar(255)
  Invoice     Invoice @relation(fields: [invoiceId], references: [sohd], onDelete: Cascade, map: "payBills_ibfk_1")

  @@unique([invoiceId, code], map: "invoiceId")
}

model Webhook {
  id          Int      @id @default(autoincrement())
  type        String   @db.VarChar(255)
  url         String   @db.VarChar(255)
  isActive    Boolean  @default(true)
  description String?  @db.VarChar(255)
  secret      String   @db.VarChar(255)
  createdAt   DateTime @default(now()) @db.DateTime(0)
  updatedAt   DateTime @default(now()) @db.DateTime(0)
}

model Customer {
  id            Int       @id @default(autoincrement())
  code          String    @unique
  name          String
  gender        Boolean?
  birthDate     DateTime?
  contactNumber String
  address       String
  locationName  String
  email         String?
  modifiedDate  DateTime
  type          Int?
  organization  String?
  taxCode       String?
  comments      String?
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
}

model suppliers {
  stt                        Int       @id @default(autoincrement())
  id                         Int       @unique
  code                       String    @unique @db.VarChar(20)
  name                       String    @db.VarChar(255)
  email                      String?   @db.VarChar(50)
  contactNumber              String?   @db.VarChar(20)
  address                    String?   @db.VarChar(255)
  locationName               String?   @db.VarChar(255)
  wardName                   String?   @db.VarChar(255)
  organization               String?   @db.VarChar(255)
  comment                    String?   @db.VarChar(255)
  taxCode                    String    @db.VarChar(20)
  groups                     String?   @db.VarChar(50)
  isActive                   Boolean
  modifiedDate               DateTime? @db.DateTime(0)
  createdDate                DateTime  @db.DateTime(0)
  retailerId                 Int?
  branchId                   Int?
  createdBy                  String?   @db.VarChar(50)
  debt                       Decimal?  @db.Decimal(18, 4)
  totalInvoiced              String?
  totalInvoicedWithoutReturn String?
}

model category {
  id             Int        @id @default(autoincrement())
  name           String     @db.VarChar(255)
  level          Int
  parent_id      Int?
  createdBy      String?    @db.VarChar(255)
  isActive       Boolean?
  createDate     DateTime?  @db.DateTime(0)
  modifiedDate   DateTime?  @db.DateTime(0)
  category       category?  @relation("categoryTocategory", fields: [parent_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "category_ibfk_1")
  other_category category[] @relation("categoryTocategory")

  @@index([parent_id], map: "parent_id")
}

model suppliersLocal {
  id            Int       @id @default(autoincrement())
  code          String?   @unique(map: "code") @db.VarChar(50)
  name          String?   @db.VarChar(255)
  organization  String?   @db.VarChar(255)
  taxCode       String?   @db.VarChar(20)
  email         String?   @db.VarChar(50)
  address       String?   @db.VarChar(255)
  contactNumber String?   @db.VarChar(20)
  isActive      Boolean?
  createdDate   DateTime? @db.DateTime(0)
  modifiedDate  DateTime? @db.DateTime(0)
  createdBy     String?   @db.VarChar(255)
}

model invoiceIt {
  soHd             Int
  kyHieuHd         String             @db.VarChar(20)
  ngayHd           String             @db.VarChar(50)
  loaiHinh         String             @db.VarChar(20)
  noiDung          String             @db.Text
  tienThue         Int
  tongTien         Int
  createDate       DateTime?          @db.Timestamp(0)
  userId           Int?
  ptThanhToan      String             @db.VarChar(50)
  mst              String?            @db.VarChar(20)
  tenNcc           String?            @db.VarChar(255)
  diaChi           String?            @db.VarChar(255)
  soDt             Int?
  email            String?            @db.VarChar(255)
  stk              String?            @db.VarChar(50)
  nganHang         String?            @db.VarChar(255)
  webSite          String?            @db.VarChar(255)
  soTienBangChu    String?            @db.VarChar(255)
  tyGia            Int?
  caNhan           String?            @db.VarChar(255)
  file             String?            @db.VarChar(255)
  id               Int                @id @default(autoincrement())
  modifiedDate     DateTime?          @db.Timestamp(0)
  status           Boolean?
  users            users?             @relation(fields: [userId], references: [userId], onDelete: NoAction, onUpdate: NoAction, map: "invoiceIt_ibfk_1")
  invoiceItDetails invoiceItDetails[]

  @@unique([soHd, kyHieuHd])
  @@index([userId], map: "userId")
}

model invoiceItDetails {
  id                Int       @id @default(autoincrement())
  danhSachHang      String    @db.VarChar(255)
  dvt               String    @db.VarChar(20)
  sl                Int
  donGia            Int
  thanhTienTruocVat Int
  loaiThue          String    @db.VarChar(5)
  tienThueDongHang  Int
  thanhTien         Int
  tongTien          Int
  userId            Int?
  createDate        DateTime? @db.Date
  invoiceItId       Int
  modifiedDate      DateTime? @db.Timestamp(0)
  status            Boolean?
  users             users?    @relation(fields: [userId], references: [userId], onDelete: NoAction, onUpdate: NoAction, map: "invoiceItDetails_ibfk_2")
  invoiceIt         invoiceIt @relation(fields: [invoiceItId], references: [id], onDelete: Cascade)

  @@index([userId], map: "userId")
  @@index([invoiceItId])
}

model users {
  userId           Int                @id @default(autoincrement())
  userName         String             @db.VarChar(255)
  pass             String             @db.VarChar(255)
  email            String?            @db.VarChar(255)
  brithday         String?            @db.VarChar(255)
  phone            String?            @db.VarChar(10)
  fullName         String?            @db.VarChar(255)
  createDate       DateTime           @db.Timestamp(0)
  status           Boolean?
  modifiedDate     String?            @db.VarChar(255)
  vaiTro           String?            @db.VarChar(255)
  address          String?            @db.VarChar(255)
  refreshToken     String?            @db.VarChar(255)
  invoiceIt        invoiceIt[]
  invoiceItDetails invoiceItDetails[]
  userPass         userPass[]
}

model message {
  id         Int       @id @default(autoincrement())
  userId     String    @db.VarChar(255)
  userMsg    String    @db.Text
  botReply   String    @db.Text
  createDate DateTime? @db.Timestamp(0)
}

model branches {
  stt           Int     @id @default(autoincrement())
  id            Int?
  branchName    String? @db.VarChar(50)
  address       String? @db.VarChar(255)
  locationName  String? @db.VarChar(255)
  wardName      String? @db.VarChar(255)
  contactNumber String? @db.VarChar(255)
  retailerId    Int?
  modifiedDate  String? @db.VarChar(255)
  createdDate   String? @db.VarChar(255)
  email         String? @db.VarChar(255)
}

model categoryKiot {
  stt                    Int                      @id @default(autoincrement())
  categoryId             Int                      @unique(map: "categoryId")
  categoryName           String?                  @db.VarChar(100)
  retailerId             Int?
  hasChild               Boolean?
  modifiedDate           String?                  @db.VarChar(255)
  createdDate            String?                  @db.VarChar(255)
  childrenL2CategoryKiot childrenL2CategoryKiot[]
}

model childrenL2CategoryKiot {
  id                     Int                      @id @default(autoincrement())
  categoryId             Int                      @unique(map: "categoryId")
  parentId               Int?
  categoryName           String?                  @db.VarChar(100)
  retailerId             Int?
  hasChild               Boolean?
  createdDate            String?                  @db.VarChar(255)
  modifiedDate           String?                  @db.VarChar(255)
  categoryKiot           categoryKiot?            @relation(fields: [parentId], references: [categoryId], onDelete: Cascade, onUpdate: NoAction, map: "childrenL2CategoryKiot_ibfk_1")
  childrenL3CategoryKiot childrenL3CategoryKiot[]

  @@unique([parentId, categoryName], map: "childrenL2CategoryKiot_parentId_categoryName")
}

model childrenL3CategoryKiot {
  id                     Int                     @id @default(autoincrement())
  categoryId             Int?
  parentId               Int?
  categoryName           String?                 @db.VarChar(100)
  retailerId             Int?
  hasChild               Boolean?
  createdDate            String?                 @db.VarChar(255)
  modifiedDate           String?                 @db.VarChar(255)
  childrenL2CategoryKiot childrenL2CategoryKiot? @relation(fields: [parentId], references: [categoryId], onDelete: Cascade, onUpdate: NoAction, map: "childrenL3CategoryKiot_ibfk_1")

  @@unique([parentId, categoryName], map: "childrenL3CategoryKiot_parentId_categoryName")
}

model invoiceDetailTaxs {
  id                          Int            @id @default(autoincrement())
  detailId                    Int
  detailTax                   Decimal?       @db.Decimal(18, 4)
  taxId                       Int?
  name                        String?        @db.VarChar(255)
  value                       Decimal?       @db.Decimal(18, 4)
  allocationDiscountAfterTax  Decimal?       @db.Decimal(18, 4)
  discountByPromotionAfterTax Decimal?       @db.Decimal(18, 4)
  discountAfterTax            Decimal?       @db.Decimal(18, 4)
  viewDiscountAfterTax        Decimal?       @db.Decimal(18, 4)
  priceAfterTax               Decimal?       @db.Decimal(18, 4)
  invoiceDetails              invoiceDetails @relation(fields: [detailId], references: [id], onDelete: Cascade)

  @@unique([detailId, taxId])
}

model returnDetails {
  id            Int           @id @default(autoincrement())
  code          String        @db.VarChar(255)
  productId     Int?
  productCode   String?       @db.VarChar(50)
  productName   String?       @db.VarChar(255)
  quantity      Int?
  price         Decimal?      @db.Decimal(18, 4)
  usePoint      Boolean?
  subTotal      Int?
  note          String?       @db.VarChar(255)
  returnInvoice returnInvoice @relation(fields: [code], references: [code], onDelete: Cascade, onUpdate: NoAction, map: "returnDetails_ibfk_1")

  @@unique([code, productId])
}

model returnInvoice {
  stt            Int             @id @default(autoincrement())
  id             Int
  code           String          @unique(map: "code") @db.VarChar(50)
  invoiceId      Int?
  returnDate     String?         @db.VarChar(255)
  branchId       Int?
  branchName     String?         @db.VarChar(50)
  receivedById   Int?
  soldByName     String?         @db.VarChar(255)
  customerId     Int?
  customerCode   String?         @db.VarChar(255)
  customerName   String?         @db.VarChar(255)
  returnTotal    Decimal?        @db.Decimal(18, 4)
  returnDiscount Decimal?        @db.Decimal(18, 4)
  totalPayment   Int?
  returnFee      Decimal?        @db.Decimal(18, 4)
  status         Int?
  statusValue    String?         @db.VarChar(50)
  description    String?         @db.VarChar(255)
  createdDate    String?         @db.VarChar(255)
  modifiedDate   String?         @db.VarChar(255)
  totalTax       Int?
  saleChannelId  Int?
  returnDetails  returnDetails[]
  Invoice        Invoice?        @relation(fields: [invoiceId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "returnInvoice_ibfk_1")

  @@index([invoiceId], map: "invoiceId")
}

model transfers {
  stt              Int                @id @default(autoincrement())
  code             String             @unique(map: "code") @db.VarChar(50)
  description      String?            @db.VarChar(255)
  dispatchedDate   String?            @db.VarChar(255)
  fromBranchId     Int?
  id               Int
  isActive         Boolean?
  receivedDate     String?            @db.VarChar(255)
  retailerId       Int?
  status           Int?
  toBranchId       Int?
  transfersDetails transfersDetails[]
}

model transfersDetails {
  id              Int       @id @default(autoincrement())
  code            String    @db.VarChar(50)
  productId       Int?
  productCode     String?   @db.VarChar(255)
  productName     String?   @db.VarChar(255)
  sendQuantity    Int?
  receiveQuantity Int?
  sendPrice       Decimal?  @db.Decimal(18, 4)
  receivePrice    Decimal?  @db.Decimal(18, 4)
  price           Decimal?  @db.Decimal(18, 4)
  transferId      Int?
  transfers       transfers @relation(fields: [code], references: [code], onDelete: Cascade, onUpdate: NoAction, map: "transfersDetails_ibfk_1")

  @@unique([code, productCode], map: "transfersDetails_code_productCode")
}

model attributes {
  id             Int          @id @default(autoincrement())
  kiotProductId  Int?
  attributeName  String?      @db.VarChar(20)
  attributeValue String?      @db.VarChar(20)
  productKiot    productKiot? @relation(fields: [kiotProductId], references: [kiotProductId], onDelete: Cascade, map: "attributes_ibfk_1")

  @@unique([kiotProductId, attributeName], map: "kiotProductId_attributeName")
}

model inventoriesKiot {
  id             Int          @id @default(autoincrement())
  kiotProductId  Int?
  productCode    String?      @db.VarChar(30)
  productName    String?      @db.VarChar(255)
  branchId       Int?
  branchName     String?      @db.VarChar(30)
  cost           Decimal?     @db.Decimal(18, 4)
  onHand         Int?
  reserved       Int?
  actualReserved Int?
  minQuantity    Int?
  maxQuantity    Int?
  isActive       Boolean?
  onOrder        Int?
  productKiot    productKiot? @relation(fields: [kiotProductId], references: [kiotProductId], onDelete: Cascade, map: "inventoriesKiot_ibfk_1")

  @@unique([kiotProductId, branchId], map: "inventoriesKiot")
}

model productKiot {
  id                   Int                  @id @default(autoincrement())
  createdDate          String?              @db.VarChar(255)
  masterCode           String?              @db.VarChar(50)
  masterProductId      Int?
  tradeMarkName        String?              @db.VarChar(50)
  tradeMarkId          Int?
  taxType              String?              @db.VarChar(255)
  taxRate              String?              @db.VarChar(50)
  taxname              String?              @db.VarChar(50)
  kiotProductId        Int?                 @unique(map: "productKiot_kiotProductId")
  retailerId           Int?
  code                 String?              @db.VarChar(100)
  barCode              String?              @db.VarChar(50)
  name                 String?              @db.VarChar(255)
  fullName             String?              @db.VarChar(255)
  categoryId           Int?
  categoryName         String?              @db.VarChar(50)
  allowsSale           Boolean?
  type                 Int?
  hasVariants          Boolean?
  basePrice            Decimal?             @db.Decimal(18, 4)
  weight               Int?
  unit                 String?              @db.VarChar(20)
  conversionValue      Int?
  modifiedDate         String?              @db.VarChar(255)
  isActive             Boolean?
  description          String?              @db.VarChar(255)
  isRewardPoint        Boolean?
  isLotSerialControl   Boolean?
  isBatchExpireControl Boolean?
  orderTemplate        String?              @db.VarChar(255)
  attributes           attributes[]
  inventoriesKiot      inventoriesKiot[]
  productKiotTax       productKiotTax[]
  productPurchaseTax   productPurchaseTax[]
}

model productKiotTax {
  id            Int          @id @default(autoincrement())
  kiotProductId Int?
  taxId         Int?
  name          String?      @db.VarChar(30)
  value         Decimal?     @db.Decimal(18, 4)
  productKiot   productKiot? @relation(fields: [kiotProductId], references: [kiotProductId], onDelete: Cascade, map: "productKiotTax_ibfk_1")

  @@unique([kiotProductId, taxId], map: "kiotProductId_taxId")
}

model productPurchaseTax {
  id            Int          @id @default(autoincrement())
  kiotProductId Int?
  taxId         Int?
  value         Decimal?     @db.Decimal(18, 4)
  name          String?      @db.VarChar(20)
  productKiot   productKiot? @relation(fields: [kiotProductId], references: [kiotProductId], onDelete: Cascade, map: "productPurchaseTax_ibfk_1")

  @@unique([kiotProductId, taxId], map: "kiotProductId_taxId")
}

model payments {
  id          BigInt     @id
  code        String?    @db.VarChar(20)
  amount      Decimal?   @db.Decimal(18, 4)
  method      String?    @db.VarChar(20)
  status      Int?
  statusValue String?    @db.VarChar(30)
  transDate   String?    @db.VarChar(255)
  purcharse   purcharse? @relation(fields: [code], references: [code], onDelete: Cascade, map: "payments_ibfk_1")

  @@unique([id, code], map: "id_code")
  @@index([code], map: "code")
}

model purcharse {
  id                   BigInt                 @id
  retailerId           BigInt?
  code                 String                 @unique(map: "purcharse_code") @db.VarChar(50)
  description          String?                @db.VarChar(255)
  branchId             Int?
  branchName           String?                @db.VarChar(20)
  purchaseDate         String?                @db.VarChar(255)
  discount             Decimal?               @db.Decimal(18, 4)
  discountRatio        Int?
  total                Decimal?               @db.Decimal(18, 4)
  totalPayment         Int?
  status               Int?
  createdDate          String?                @db.VarChar(255)
  supplierId           Int?
  supplierName         String?                @db.VarChar(50)
  supplierCode         String?                @db.VarChar(20)
  purchaseById         Int?
  purchaseName         String?                @db.VarChar(255)
  exReturnSuppliers    Decimal?               @db.Decimal(18, 4)
  exReturnThirdParty   Decimal?               @db.Decimal(18, 4)
  totalTax             Decimal?               @db.Decimal(18, 4)
  payments             payments[]
  purchaseOrderDetails purchaseOrderDetails[]
}

model purchaseOrderDetailTaxes {
  id                   BigInt                @id @default(autoincrement())
  lineNo               Int?
  code                 String?               @db.VarChar(50)
  detailId             BigInt?
  retailerId           Int?
  taxId                Int?
  detailTax            Decimal?              @db.Decimal(18, 4)
  taxName              String?               @db.VarChar(20)
  taxValue             Decimal?              @db.Decimal(18, 4)
  purchaseOrderDetails purchaseOrderDetails? @relation(fields: [code, lineNo], references: [code, lineNo], onDelete: Cascade, map: "purchaseOrderDetailTaxes_ibfk_1")

  @@unique([code, lineNo, taxId], map: "uk_code_line_tax")
}

model purchaseOrderDetails {
  id                       BigInt                     @id @default(autoincrement())
  lineNo                   Int
  code                     String?                    @db.VarChar(50)
  productId                Int?
  masterUnitId             Int?
  productCode              String?                    @db.VarChar(20)
  productName              String?                    @db.VarChar(255)
  quantity                 Int?
  price                    Decimal?                   @db.Decimal(18, 4)
  discount                 Decimal?                   @db.Decimal(18, 4)
  discountRatio            Int?
  purchaseOrderDetailTaxes purchaseOrderDetailTaxes[]
  purcharse                purcharse?                 @relation(fields: [code], references: [code], onDelete: Cascade, map: "purchaseOrderDetails_ibfk_1")

  @@unique([code, lineNo], map: "code_lineNo")
}

model userPass {
  id     Int     @id @default(autoincrement())
  userId Int?
  pass   String? @db.VarChar(255)
  users  users?  @relation(fields: [userId], references: [userId], onDelete: Cascade, map: "userPass_ibfk_1")

  @@index([userId], map: "userId")
}
